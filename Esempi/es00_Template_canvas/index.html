<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Esercizio 02 - Moon</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        canvas {
            display: block;
        }
    </style>
</head>

<body>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.11.1/lib/p5.min.js"></script>
    <script>
        let biglie = [];
        let numBiglie = 8;
        let velocitaBase = 0.005;
        let spaziaturaRitardo = 200;

        function setup() {
            createCanvas(windowWidth, windowHeight);
            inizializzaBiglie();
        }

        function inizializzaBiglie() {
            biglie = [];
            let mete = [{
                    x: 0,
                    y: 0
                },
                {
                    x: windowWidth / 2,
                    y: 0
                },
                {
                    x: windowWidth,
                    y: 0
                },
                {
                    x: windowWidth,
                    y: windowHeight / 2
                },
                {
                    x: windowWidth,
                    y: windowHeight
                },
                {
                    x: windowWidth / 2,
                    y: windowHeight
                },
                {
                    x: 0,
                    y: windowHeight
                },
                {
                    x: 0,
                    y: windowHeight / 2
                }
            ];

            for (let i = 0; i < numBiglie; i++) {
                biglie.push({
                    targetX: mete[i].x,
                    targetY: mete[i].y,
                    progresso: 0,
                    direzione: 1,
                    ritardo: i * -spaziaturaRitardo
                });
            }
        }

        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
            inizializzaBiglie();
        }

        function draw() {
            background(255, 0, 0);

            stroke(255);
            strokeWeight(2);
            line(0, 0, windowWidth, windowHeight);
            line(windowWidth, 0, 0, windowHeight);
            line(0, windowHeight / 2, windowWidth, windowHeight / 2);
            line(windowWidth / 2, 0, windowWidth / 2, windowHeight);

            for (let b of biglie) {
                b.ritardo++;

                if (b.ritardo > 0) {
                    b.progresso += velocitaBase * b.direzione;

                    if (b.progresso >= 1) {
                        b.progresso = 1;
                        b.direzione = -1;
                    } else if (b.progresso <= 0) {
                        b.progresso = 0;
                        b.direzione = 1;
                    }
                }

                let x = lerp(windowWidth / 2, b.targetX, b.progresso);
                let y = lerp(windowHeight / 2, b.targetY, b.progresso);

                let diametro = lerp(40, 500, b.progresso);

                stroke(255);
                strokeWeight(2);
                fill(255, 0, 0);
                ellipse(x, y, diametro, diametro);
            }
        }
    </script>
</body>

</html>